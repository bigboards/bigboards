- name: get the container details
  shell: docker inspect [[ role.name ]] 2>&1
  ignore_errors: yes
  register: container

- name: check if the container is running
  shell: docker inspect [[ role.name ]] |grep "Running" |cut -d ':' -f2
  ignore_errors: yes
  register: running

- name: stop the container
  shell: docker stop --time=10 [[ role.name ]]
  ignore_errors: yes
  when: running.stdout.find("true") != -1

- name: remove the container
  shell: docker rm -f -v [[ role.name ]]
  when: container.stdout.find('"Id":') != -1

- name: remove the container's service script
  name: make sure the service script is removed
  file: state=absent path=/etc/init/[[ role.name ]].conf